<ion-menu side="end" menuId="menuLateral" contentId="main-content">
  <ion-header>
    <ion-toolbar color="dark">
      <ion-title class="title-center">Menú</ion-title>

      <ion-buttons slot="end">
        <ion-button (click)="cerrarMenu()">
          <ion-icon name="close-outline" color="danger"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>

  <ion-content class="ion-padding">
    <ion-list>

      <!-- Configuración -->
      <div class="menu-section"
           [class.expanded]="expandedSections.configuracion"
           (click)="toggleSection('configuracion')"
           [attr.aria-expanded]="expandedSections.configuracion">
        <span>Configuración</span>
        <ion-icon [name]="expandedSections.configuracion ? 'chevron-up-outline' : 'chevron-down-outline'"></ion-icon>
      </div>

      <div class="menu-items" [class.expanded]="expandedSections.configuracion">
        <ion-item *ngIf="!isLoggedIn" (click)="redirecion('inicio')" button lines="none">
          <ion-icon name="log-in" color="danger"></ion-icon>
          <ion-label>Iniciar sesión</ion-label>
        </ion-item>

        <ion-item *ngIf="isLoggedIn" (click)="abrirModalPerfil()" button lines="none">
          <ion-icon name="person-outline" color="danger"></ion-icon>
          <ion-label>Perfil</ion-label>
        </ion-item>

        <ion-item *ngIf="isLoggedIn" (click)="logout()" button lines="none">
          <ion-icon name="log-out-outline" color="danger"></ion-icon>
          <ion-label>Cerrar sesión</ion-label>
        </ion-item>
      </div>

      <!-- Servicios (para todos, con o sin sesión) -->
      <div class="menu-section"
           [class.expanded]="expandedSections.servicios"
           (click)="toggleSection('servicios')"
           [attr.aria-expanded]="expandedSections.servicios">
        <span>Servicios</span>
        <ion-icon [name]="expandedSections.servicios ? 'chevron-up-outline' : 'chevron-down-outline'"></ion-icon>
      </div>

      <div class="menu-items" [class.expanded]="expandedSections.servicios">
        <ion-item (click)="redirecion('menu-vehiculos/autos')" button lines="none">
          <ion-icon name="car-outline" color="danger"></ion-icon>
          <ion-label>Vehículos</ion-label>
        </ion-item>

        <ion-item (click)="redirecion('m-nuevos')" button lines="none">
          <ion-icon name="bicycle-outline" color="danger"></ion-icon>
          <ion-label>Motos</ion-label>
        </ion-item>

        <ion-item (click)="redirecion('camiones/todos')" button lines="none">
          <ion-icon name="bus-outline" color="danger"></ion-icon>
          <ion-label>Camiones</ion-label>
        </ion-item>

        <ion-item (click)="redirecion('arrendamiento')" button lines="none">
          <ion-icon name="document-text-outline" color="danger"></ion-icon>
          <ion-label>Arrendamiento</ion-label>
        </ion-item>

        <ion-item (click)="redirecion('renta-coches')" button lines="none">
          <ion-icon name="document-lock-outline" color="danger"></ion-icon>
          <ion-label>Renta de coches</ion-label>
        </ion-item>

        <ion-item (click)="redirecion('seguros')" button lines="none">
          <ion-icon name="shield-checkmark-outline" color="danger"></ion-icon>
          <ion-label>Seguros de autos</ion-label>
        </ion-item>
      </div>

      <!-- Mis publicaciones (solo si hay sesión) -->
      <div *ngIf="isLoggedIn"
           class="menu-section"
           [class.expanded]="expandedSections.publicaciones"
           (click)="toggleSection('publicaciones')"
           [attr.aria-expanded]="expandedSections.publicaciones">
        <span>Mis publicaciones</span>
        <ion-icon [name]="expandedSections.publicaciones ? 'chevron-up-outline' : 'chevron-down-outline'"></ion-icon>
      </div>

      <div *ngIf="isLoggedIn"
           class="menu-items"
           [class.expanded]="expandedSections.publicaciones">
        <ion-item *ngIf="MyRole == 'admin' || MyRole == 'vendedor' || MyRole == 'lotero'"
                  (click)="redirecion('mis-autos')" button lines="none">
          <ion-icon name="car-sport-outline" color="danger"></ion-icon>
          <ion-label>Mis autos</ion-label>
        </ion-item>

        <ion-item *ngIf="MyRole == 'admin' || MyRole == 'vendedor' || MyRole == 'lotero'"
                  (click)="redirecion('mis-motos')" button lines="none">
          <ion-icon name="bicycle-outline" color="danger"></ion-icon>
          <ion-label>Mis motos</ion-label>
        </ion-item>

        <ion-item *ngIf="MyRole == 'admin' || MyRole == 'vendedor' || MyRole == 'lotero'"
                  (click)="redirecion('mis-camiones')" button lines="none">
          <ion-icon name="bus-outline" color="danger"></ion-icon>
          <ion-label>Mis camiones</ion-label>
        </ion-item>
      </div>

    </ion-list>
  </ion-content>
</ion-menu>
